<div
  class="modal fade"
  id="exampleModal2"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-md" style="margin-top: 80px;">
    <div class="modal-content modal-custom-content">
      <div class="modal-header">
        <h5 class="modal-title"></h5>
        <button
          type="button"
          class="close close-btn"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true" class="modal-close-icon">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="div" *ngIf="viewBuckFlyer">
          <h5 class="text-center mt-3 mb-3">
            {{ vendorBuckData!.vendor_name! }} PROMO FLYER
          </h5>
          <iframe
            *ngIf="vendorBuckData!.bucks.length > 0"
            title="{{ vendorBuckData!.vendor_name! }}"
            [src]="vendorBuckData!.bucks[0]!.pdf_url! | safe: 'resourceUrl'"
            width="100%"
            height="500px"
            style="background-color: #525659; border: none;"
          ></iframe>
        </div>
        <p *ngIf="!viewBuckFlyer" class="mt-3 mb-4">No Flyer Available</p>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" style="margin-top: 80px;">
    <div class="modal-content modal-custom-content">
      <div class="modal-header">
        <h5 class="modal-title"></h5>
        <button
          type="button"
          class="close close-btn"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true" class="modal-close-icon">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="d-flex flex-column">
          <div class="d-flex justify-content-center">
            <!-- <div class="img-viewer" [style.background-image]="'url(' + currentData?.img + ')'"></div> -->

            <img
              class="view-bg-img img-fluid"
              [id]="'img' + currentData?.id"
              src="
                https://atlastrailer.s3.amazonaws.com/0480-23.jpg
              "
            />
          </div>

          <div>
            <span class="view-title-label">Name</span>
            <h5 class="view-text-value">
              {{ currentData?.description }}
            </h5>
          </div>
          <div>
            <span class="view-title-label">Atlas #</span>
            <h5 class="view-text-value">
              {{ currentData?.atlas_id }}
            </h5>
          </div>

          <div>
            <span class="view-title-label">Description</span>
            <h6 class="view-text-value my-2">
              Flame King? BBQ and Grill station comes with a bracket to mount
              right onto the side of your motorhome, RV or trailer so you can
              have a cookout wherever you are! This incredibly convenient gas
              grill includes an adjustable flame controller, upper grill dec
            </h6>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div
  class="modal fade"
  id="exampleModal22"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-md" style="margin-top: 80px;">
    <div class="modal-content modal-custom-content">
      <div class="modal-header">
        <h5 class="modal-title"></h5>
        <button
          type="button"
          class="close close-btn"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true" class="modal-close-icon">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="" *ngIf="viewPromoFlyer">
          <h5 class="text-center mt-3 mb-3">
            {{ vendorBuckData!.vendor_name! }}
          </h5>
          <iframe
            title="{{ vendorBuckData!.vendor_name! }}"
            [src]="
              vendorBuckData!.promotional_fliers[0]!.pdf_url!
                | safe: 'resourceUrl'
            "
            width="100%"
            height="500px"
            style="background-color: #525659; border: none;"
          ></iframe>
        </div>
        <!-- <p *ngIf="viewPromoFlyer" class="mt-3 mb-4">No Flyer Available</p> -->
      </div>
    </div>
  </div>
</div>

<section class="overview-section">
  <div class="container-fluid p-0">
    <div class="row my-5 ml-4">
      <div class="col-12">
        <h3 class="section-header mb-4">Show Order Forms</h3>
        <div class="form-table-ctn px-2">
          <div class="header-search-ctn">
            <form action="" class="d-flex align-items-center form-wrapper">
              <span class="mr-3">Vendor Name</span>

              <!-- <button mat-button [matMenuTriggerFor]="menu">Menu</button> -->

              <div class="select-wrapper">
                <input
                  class="dummy-input"
                  type="text"
                  (click)="toggleVendors()"
                  value="Select vendor "
                  readonly
                  #dummyInput
                  mat-button
                  [matMenuTriggerFor]="menu"
                />

                <!--                 

                <div class="body-wrapper" *ngIf="showDropdown">
                  <div
                    #dropdownSection
                    class="dropdown-section"
                    id="jqxScrollBar"
                  >
                    <input
                      type="text"
                      class="dropdown-filter"
                      (keyup)="applyFilter($event)"
                      #input
                    />

                    <div>
                      <li
                        *ngFor="let data of allVendors"
                        (click)="getAllSelectedDealerUsers(data)"
                      >
                        {{ data.vendor_name }}
                      </li>
                    </div>
                  </div>
                </div> -->
              </div>

              <mat-menu #menu="matMenu" class="mat-menu">
                <!-- <div class="body-wrapper"> -->
                <div
                  #dropdownSection
                  class="dropdown-section notranslate px-0 pb-0"
                  id="jqxScrollBar"
                >
                  <span class="px-2 d-block">
                    <input
                      type="text"
                      class="dropdown-filter"
                      (keyup)="applyFilter($event)"
                      #input
                      (click)="$event.stopPropagation()"
                    />
                  </span>

                  <div class="scrollbar-fix ml-2 mr-1">
                    <li
                      class="p-3"
                      *ngFor="let data of allVendors"
                      (click)="getAllSelectedDealerUsers(data)"
                    >
                      {{ data.vendor_name }}
                    </li>
                  </div>
                </div>
                <!-- </div> -->
              </mat-menu>

              <!-- <select name="" class="form-control search-input" #vendorId>
                <option [selected]="selectVendor == 0" value="0">
                  Select Vendor
                </option>
                <option
                  class="category-text"
                  value="{{ category.vendor_code }}"
                  *ngFor="let category of allVendors"
                  [selected]="selectVendor == category.vendor_code"
                >
                  {{ category.vendor_name }}
                </option>
              </select> -->

              <button
                class="btn btn-primary ml-3"
                (click)="getProductByVendorId()"
              >
                <i class="fa fa-search me-2"></i>
                Search
              </button>
              <a
                href="#"
                *ngIf="viewFlyer"
                data-toggle="modal"
                data-target="#exampleModal2"
                class="ml-3"
                title="click to view show buck flyer"
              >
                <img
                  *ngIf="vendorBuckData.bucks[0]!"
                  src="{{ vendorBuckData.bucks[0]!.img_url! }}"
                  class="showbuck-img"
                />
              </a>
              <div *ngIf="viewPromoFlyer" class="ml-3 mt-3">
                <a href="#" data-toggle="modal" data-target="#exampleModal22">
                  CLICK TO VIEW PROMOTIONAL FLYER
                </a>
              </div>
            </form>
          </div>

          <div
            class="table-ctn p-3 table-responsive mt-2"
            style="overflow-y: scroll; background-color: white;"
            id="formtable"
          >
            <table class="table" *ngIf="loader">
              <thead>
                <tr>
                  <td class="loader-td" colspan="8">
                    <div
                      class="ph-item"
                      style="padding: 0px 0px; border: 0px; margin-bottom: 0px;"
                    >
                      <div>
                        <div class="ph-picture"></div>
                      </div>
                    </div>
                  </td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="loader-td">
                    <div
                      class="ph-item"
                      style="
                        padding: 10px 10px;
                        border: 0px;
                        margin-bottom: 0px;
                      "
                    >
                      <div>
                        <div class="ph-row pt-2">
                          <div class="ph-col-12 p-1 rounded"></div>
                          <div class="ph-col-12 p-1 rounded"></div>
                        </div>
                      </div>
                    </div>
                  </td>

                  <td class="loader-td">
                    <div
                      class="ph-item"
                      style="
                        padding: 10px 10px;
                        border: 0px;
                        margin-bottom: 0px;
                      "
                    >
                      <div>
                        <div class="ph-row pt-2">
                          <div class="ph-col-12 p-1 rounded"></div>
                          <div class="ph-col-12 p-1 rounded"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="loader-td">
                    <div
                      class="ph-item"
                      style="
                        padding: 10px 10px;
                        border: 0px;
                        margin-bottom: 0px;
                      "
                    >
                      <div>
                        <div class="ph-row pt-2">
                          <div class="ph-col-12 p-1 rounded"></div>
                          <div class="ph-col-12 p-1 rounded"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>

            <div class="d-flex justify-content-between align-items-center">
              <div>
                <mat-paginator
                  [pageSizeOptions]="[100, 200, 500]"
                  showFirstLastButtons
                  aria-label="Select page seminar pages"
                ></mat-paginator>
              </div>
              <div>
                <span class="desc-text">Total: {{ overTotal | currency }}</span>
              </div>
            </div>
            <div class="d-flex justify-content-end">
              <div>
                <input
                  (keyup)="atlasIdFilter($event)"
                  placeholder="Search columns"
                  #input
                  type="text"
                  placeholder="Search...."
                  class="table-search"
                />
              </div>
            </div>
            <table
              *ngIf="tableView"
              class="order-form-table w-100 mat-elevation table-striped"
              mat-table
              [dataSource]="dataSrc"
              matSort
              (matSortChange)="sortData($event)"
            >
              <ng-container matColumnDef="qty">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  style="white-space: nowrap;"
                >
                  Qty
                </th>
                <td
                  mat-cell
                  *matCellDef="let element; let i = index"
                  class="text-center"
                >
                  <input
                    [disabled]="alreadyOrder"
                    id="cur-{{ element.position }}"
                    [value]="element.qty"
                    type="number"
                    class="mx-auto"
                    style="text-align: center;"
                    min="0"
                    #inputAmt
                    placeholder="Qty"
                    (keyup)="
                      runCalculation(
                        element.position,
                        inputAmt.value,
                        $event,
                        element.atlas_id
                      )
                    "
                    (keypress)="omitSpecialChar($event)"
                  />
                  <!-- <span>{{ element.position }}</span> -->
                </td>
              </ng-container>
              <ng-container matColumnDef="atlas_id">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  class="mx-auto"
                  mat-sort-header="atlas_id"
                >
                  Atlas #
                  <i class="fa fa-sort ml-2"></i>
                </th>
                <td
                  mat-cell
                  *matCellDef="let element"
                  title="click to view product info"
                  (click)="viewProduct(element)"
                  style="cursor: pointer;"
                  data-toggle="modal"
                  class="clickable"
                  data-target="#exampleModal"
                >
                  <div class="d-flex justify-content-center">
                    <span>{{ element.atlas_id! }}</span>
                    <span
                      class="new ml-2 mt-1"
                      *ngIf="element?.check_new!"
                    ></span>
                  </div>
                </td>
              </ng-container>
              <ng-container matColumnDef="vendor">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  class="mx-auto"
                  style="cursor: pointer;"
                  (click)="sortDataAlt()"
                >
                  Vendor #
                  <i class="fa fa-sort ml-2"></i>
                </th>
                dealer-dealer
                <td
                  mat-cell
                  *matCellDef="let element"
                  title="click to view product info"
                  class="clickable"
                  (click)="viewProduct(element)"
                  style="cursor: pointer;"
                  data-toggle="modal"
                  data-target="#exampleModal"
                >
                  {{ element.vendor_product_code }}
                </td>
              </ng-container>
              <!-- Name Column -->
              <ng-container matColumnDef="description">
                <th mat-header-cell *matHeaderCellDef>Description</th>
                <th></th>
                <td mat-cell *matCellDef="let element" class="short-note-con">
                  <span class="desc-text">{{ element.description! }}</span>
                  <span *ngFor="let spec of element.spec_data!; let l = index">
                    <span
                      [class.assorted-color]="spec.type == 'assorted'"
                    ></span>
                    <span
                      [class.assorted-color]="spec.type == 'assorted'"
                      [class.quantity-color]="spec.type == 'special'"
                    >
                      {{ spec.desc }}
                    </span>
                  </span>
                </td>
              </ng-container>

              <ng-container matColumnDef="booking">
                <th mat-header-cell *matHeaderCellDef>Regular ($)</th>

                <td mat-cell *matCellDef="let element" class="text-center">
                  <span class="booking-text text-center">
                    {{ element.regular }}
                  </span>
                </td>
              </ng-container>
              <ng-container matColumnDef="special">
                <th mat-header-cell *matHeaderCellDef>Special ($)</th>

                <td
                  mat-cell
                  *matCellDef="let element; let i = index"
                  class="text-center"
                >
                  <span class="booking-text">
                    {{ element.booking | currency }}
                    <span
                      *ngIf="checkSpecials(element)"
                      class="ticker fa fa-check normal-booking-{{
                        element.position
                      }}"
                    ></span>
                    <span
                      id="u-price-{{ element.position }}"
                      class="u-price-text"
                    ></span>
                  </span>

                  <span *ngFor="let spec of element.spec_data; let j = index">
                    <span
                      [class.assorted-color]="spec.type == 'assorted'"
                      [class.quantity-color]="spec.type == 'special'"
                    >
                      {{ spec.special | currency }}
                      <!-- <span
                        class="ticker fa fa-check special-booking-{{
                          element.position
                        }}-{{ j }}"
                        id=""
                      ></span> -->
                      <span
                        *ngIf="checkSpecials(element, j)"
                        class="ticker fa fa-check special-booking-{{
                          element.position
                        }}-{{ j }}"
                      ></span>
                      <!-- <span
                        *ngIf="element.qty > element.cond"
                        class="ticker fa fa-check"
                      ></span> -->
                    </span>
                  </span>
                </td>
              </ng-container>
              <ng-container matColumnDef="extended">
                <th mat-header-cell *matHeaderCellDef>Extended ($)</th>

                <td
                  mat-cell
                  *matCellDef="let element; let i = index"
                  class="text-center"
                >
                  <span
                    #extend
                    *ngIf="element.price !== ''"
                    class="total-text"
                    id="amt-{{ element.position }}"
                  >
                    {{ element.price }}
                  </span>

                  <!-- <span #extend class="total-text" id="amt-{{ i }}">
                    {{ element.price }}
                  </span> -->

                  <span
                    id="amt-hidd-{{ element.position }}"
                    style="display: none;"
                  ></span>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: displayedColumns; let i = index"
                [class.highlighted]="i == highlightIndex! && isMod"
              ></tr>
              <tr>
                <td
                  colspan="10"
                  class="p-4"
                  style="
                    padding: 5px;
                    background: rgb(223, 222, 222) !important;
                  "
                ></td>
              </tr>
            </table>

            <div class="d-flex justify-content-end" *ngIf="tableView">
              <span class="desc-text">Total: {{ overTotal | currency }}</span>
            </div>

            <div
              *ngIf="showSubmittedDetails"
              class="alert alert-success mt-2 mb-2 d-flex align-items-center"
            >
              <i class="fa fa-check-circle" style="font-size: 30px;"></i>
              &nbsp;&nbsp;
              <div class="ml-2">
                <h6 class="mb-1" style="font-size: 16px;">Success</h6>
                <p style="font-size: 15px;">
                  {{ itemNewlySubmitted }} new item(s) have been submitted
                </p>
                <p style="font-size: 15px;" *ngIf="itemAlreadySubmitted != ''">
                  The following item(s) have already been ordered. You can
                  adjust them in the Edit Order page:
                  {{ itemAlreadySubmitted }}
                </p>
              </div>
            </div>
            <div
              class="w-100 justify-content-end d-flex py-3"
              *ngIf="canOrder"
              style="border-top: 0.2px solid rgba(98, 98, 98, 0.484);"
            >
              <button
                class="btn text-bold text-white btn-primary"
                [disabled]="cartLoader || alreadyOrder"
                (click)="oneAddBtn()"
              >
                <div *ngIf="!cartLoader">Confirm Order</div>
                <div *ngIf="cartLoader">
                  Confirm Order
                  <span
                    class="spinner-border spinner-border-sm text-white ps-1"
                  ></span>
                </div>
              </button>
            </div>
            <div class="d-flex flex-column indicator-wrapper">
              <div class="d-flex">
                <div>
                  <div class="indicator-color"></div>
                </div>
                <div>
                  <h6>Quantity Break Items</h6>
                </div>
              </div>
              <div class="d-flex">
                <div>
                  <div class="indicator-color"></div>
                </div>
                <div>
                  <h6>Assorted Items</h6>
                </div>
              </div>
              <div class="d-flex">
                <div>
                  <div class="indicator-color"></div>
                </div>
                <div>
                  <h6>Regular Show Priced Items</h6>
                </div>
              </div>
              <div class="d-flex">
                <div>
                  <div class="new-indicator"></div>
                </div>
                <div>
                  <h6>New Items</h6>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
